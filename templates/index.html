<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>画像結合アプリ</title>
    <style>
        body { font-family: sans-serif; margin: 2em; }
        h3 { border-bottom: 2px solid #007bff; padding-bottom: 0.3em; }
        
        /* ★変更点: 画像スロットを横並びにする設定 */
        .image-slots-container {
            display: flex;
            flex-wrap: wrap; /* 画面が狭い場合に折り返す */
            gap: 1em; /* スロット間の隙間 */
        }

        .image-slot { 
            border: 1px solid #ccc; 
            padding: 1em;
            display: flex;
            flex-direction: column; /* スロット内の要素を縦に並べる */
            align-items: center;
            width: 200px; /* 各スロットの幅を固定 */
        }
        .image-slot label { font-weight: bold; margin-bottom: 0.5em; }
        .image-preview {
            width: 192px;  /* 幅を固定 */
            height: 108px; /* 高さを固定 */
            border: 1px solid #ddd;
            margin-top: 1em;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            overflow: hidden; /* はみ出した部分を隠す */
        }
        .image-preview img {
            max-width: 100%;
            max-height: 100%;
        }
        .layout-options { margin-top: 1em; margin-bottom: 1em; }
        .submit-button {
            font-size: 1.2em;
            padding: 0.5em 1em;
            margin-top: 1em;
            cursor: pointer;
        }
        #layout-sample {
            border: 1px solid #007bff;
        }
    </style>
</head>
<body>
    <h1>画像結合アプリ</h1>
    
    <form action="/combine" method="post" enctype="multipart/form-data">
        
        <h3>1. 画像を選択してください</h3>
        <div class="image-slots-container">
            <script>
                // JavaScriptで5つのスロットを動的に生成
                for (let i = 1; i <= 5; i++) {
                    document.write(`
                        <div class="image-slot">
                            <label for="image${i}">画像${i}:</label>
                            <input type="file" id="image${i}" name="image_files" accept="image/*" onchange="previewImage(this, 'preview${i}')">
                            <div id="preview${i}" class="image-preview">
                                <span>プレビュー</span>
                            </div>
                        </div>
                    `);
                }
            </script>
        </div>

        <h3>2. 出力レイアウトを選択してください</h3>
        <div class="layout-options">
            <input type="radio" id="layout_2x2" name="layout" value="2x2" checked>
            <label for="layout_2x2">2x2 (3840x2160px)</label>
